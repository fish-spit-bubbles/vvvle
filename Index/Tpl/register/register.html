<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Register | 注册界面</title>
    <link type="text/css" rel="stylesheet" href="https://cdn.bootcss.com/normalize/6.0.0/normalize.min.css" />
    <link rel="stylesheet" type="text/css" href="__ROOT__/Index/Common/libs/bootstrap/css/bootstrap.min.css" />
    <link rel="icon" href="__ROOT__/animated_favicon.gif" type="image/gif"> 
    <!-- 头部尾部侧边栏CSS -->
    <link rel="stylesheet" type="text/css" href="__ROOT__/Index/Common/css/guard.css" />


    <link rel="stylesheet" type="text/css" href="__ROOT__/Index/Common/css/lens.css" />

    <script type="text/javascript" src="__ROOT__/Index/Common/js/jquery.min.js"></script>
    <script type="text/javascript" src="__ROOT__/Index/Common/js/angular.min.js"></script>
    <style>
        .register_box {
            width: 972px;
            margin: 20px auto;
            overflow: hidden;
            border: #ddd solid 2px;
            padding-bottom: 20px;
        }
        
        #register_left {
            width: 435px;
            margin: 40px 0px 0px 60px;
            overflow: hidden;
        }
        
        #register_right {
            width: 330px;
            margin: 120px 80px 0;
        }
        
        .weile {
            font-size: 14px;
            color: #f3116c;
            font-weight: bold;
        }
        
        .bg {
            height: 36px;
            line-height: 36px;
            margin-top: 10px;
            width: 322px;
            padding-left: 5px;
            width: 302px;
            border: 1px solid #cfcfcf;
        }
        
        .bg01 {
            height: 36px;
            line-height: 36px;
            margin-top: 20px;
            width: 322px;
            padding-left: 5px;
            width: 302px;
        }
        
        .liji {
            background: url(__ROOT__/Index/Common/img/login/liji.gif) no-repeat;
            width: 109px;
            height: 40px;
            border: 0px;
        }
        
        .wl {
            font-size: 14px;
            padding-left: 14px;
        }
        
        .liji1 {
            padding: 15px 0;
        }
        
        .qita {
            font-size: 12px;
            color: #868686;
            padding-top: 36px;
        }
        
        .pd {
            padding-right: 15px;
            padding-top: 20px;
        }
        
        #repwd {
            padding-top: 0;
            padding-right: 15px;
            display: table-cell;
        }
        #pwd_lower{
                 border-bottom: 2px solid red; 
                 text-align: center;
        } 
        #pwd_middle{
                 border-bottom: 2px solid red; 
                 text-align: center;
        }
        #pwd_high{
                 border-bottom: 2px solid red; 
                 text-align: center;
        } 
        .pwd_bottom{
             text-align: center;
             border-bottom: 2px solid lightgrey;
        }  
    </style>
</head>
<body ng-app="myapp" ng-controller="mycontroller">
    <!--头部  -->
    <include file="Public:header" />
    <!--注册栏  -->
    <div class="register_box">
        <div class="row">
            <!--右边注册信息界面  -->
            <div class="col-sm-6" id="register_left">
                <div class="weile">注册微乐</div>
                <form name="myForm" novalidate="novalidate">
                    <table width="100%" border="0" align="left" cellpadding="5" cellspacing="3">
                        <tr>
                            <td width="20%" align="right">
                                <p class="pd">用户名</p>
                            </td>
                            <td width="80%">
                                <!-- input 用户名   -->
                                <input ng-model="users.username" type="text" ng-required="true" ng-minlength="3" class="bg" name="username" />
                                <span id="username_notice" style="color:#FF0000"> *</span>
                                <span
                                 ng-cloak                                
                                 style="color:#FF0000;font-size: 12px;"                                
                                ng-show="myForm.username.$error.required && myForm.username.$dirty"
                                >账号不能少于 3 个字符。</span>
                                <span
                                 ng-cloak
                                style="color:darkorange;font-size: 12px;"                                
                                ng-show="myForm.username.$valid"
                                >账号可以用</span>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">
                                <p class="pd">email</p>
                            </td>
                            <td>
                                <!-- input 邮件  -->
                                <input ng-model="users.email" type="email" class="bg" name="email" ng-required="true"  />
                                <span id="email_notice" style="color:#FF0000"> *</span>
                                <span 
                                 ng-cloak
                                style="color:darkorange;font-size: 12px;"
                                ng-show="myForm.email.$dirty && myForm.email.$valid">邮箱可以用。</span>
                                <span 
                                 ng-cloak
                                style="color:#FF0000;font-size: 12px;"
                                ng-show="myForm.email.$error.email">非法的邮箱地址。</span>  
                            </td>
                        </tr>
                        <tr>
                            <td align="right">
                                <p class="pd">密码</p>
                            </td>
                            <td>
                                 <!-- input 密码  -->
                                <input ng-model="users.pwd" type="password" class="bg" name="pwd"
                                ng-minlength="6"
                                ng-required="true"
                                ng-change="myFunc()"
                                />
                                <span style="color:#FF0000" id="password_notice"> *</span>
                                <span
                                ng-cloak
                                style="color:#FF0000;font-size: 12px;"                                
                                ng-show="myForm.pwd.$error.required && myForm.pwd.$dirty"
                                >登录密码不能少于 6 个字符。</span>
                                <span
                                 ng-cloak
                                style="color:darkorange;font-size: 12px;"                                
                                ng-show="myForm.pwd.$valid"
                                >密码可以用</span>
                            </td>
                        </tr>
                        <tr class="bg01">
                            <td align="right">
                                <p id="repwd">密码强度</p>
                            </td>
                            <td>
                                <table width="145" border="0" cellspacing="0" cellpadding="0" >
                                    <tr align="right" >
                                        <td width="33%" class="pwd_bottom" >弱</td>
                                        <td width="33%" class="pwd_bottom" >中</td>
                                        <td width="33%" class="pwd_bottom" >强</td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">
                                <p class="pd">确认密码</p>
                            </td>
                            <td>
                                <!-- input 确认密码  -->
                            <input  ng-model="users.repwd" type="password" class="bg"
                                    name="repwd"
                                    ng-minlength="6"
                                    ng-required="true"
                            />
                            <span style="color:#FF0000" id="conform_password_notice"> *</span>
                            <span
                                ng-cloak
                                style="color:#FF0000;font-size: 12px;"                                
                                ng-show="myForm.repwd.$error.required && myForm.repwd.$dirty"
                                >登录密码不能少于 6 个字符。</span>
                                <span
                                 ng-cloak
                                style="color:darkorange;font-size: 12px;"                                
                                ng-show="myForm.repwd.$valid"
                                >密码可以用</span>
                            </td>
                        </tr>

                        <tr>
                            <td align="right">
                                <p class="pd">QQ</p>
                            </td>
                            <td>
                                <!-- input QQ  -->
                                <input ng-model="users.qq" type="text" class="bg" />
                            </td>
                        </tr>
                        <tr>
                            <td align="right" id="WeChat">
                                <p class="pd">微信</p>
                            </td>
                            <td>
                                <!-- input 微信  -->
                                <input ng-model="users.wechat" type="text" class="bg" id="WeChat" />
                            </td>
                        </tr>
                        <tr>
                            <td>&nbsp;</td>
                            <td>
                                <label>
                                    <input type="checkbox" value="1" checked="checked" />
                                    我已看过并接受《<a class="bg" href="##" style="color:blue">用户协议</a>》
                                </label>
                            </td>
                        </tr>
                        <tr>
                            <td>&nbsp;</td>
                            <td align="left">
                                <input ng-click="sub()" type="button" class="liji">
                            </td>
                        </tr>
                    </table>
                </form>
            </div>
            <!--立即登陆  -->
            <div class="col-sm-6" id="register_right">
                <div class="wl">已微乐账号？</div>
                <div class="liji1">
                    <a href="__APP__/Login/login"><img src="__ROOT__/Index/Common/img/login/liji1.gif"></a>
                </div>
                <div class="qita">你也可以使用一下账号登录：</div>
                <div class="zhanghao">
                    <a href="##"><img src="__ROOT__/Index/Common/img/login/zhang_r1_c1.gif" width="93" height="24" border="0" /></a>
                    <a href="##"><img src="__ROOT__/Index/Common/img/login/zhang_r1_c2.gif" width="101" height="24" border="0" /></a>
                    <a href="##"><img src="__ROOT__/Index/Common/img/login/zhang_r1_c3.gif" width="75" height="24" border="0" /></a>
                </div>

            </div>
        </div>

    </div>
    <!--底部  -->
    <div class="header">
        <include file="Public:footer"/>
	</div>
	<!--侧边导航栏  -->
    <include file="Public:sidebar"/>
    <script type="text/javascript" src="__ROOT__/Index/Common/js/sidebar.js"></script>
</body>
<script type="text/javascript">
    var app = angular.module("myapp",[]);
    app.controller("mycontroller",function($scope,$http){
        $scope.users = {
            username:"",
            email:"",
            pwd:"",
            repwd:"",
            qq:"",
            wechat:""
        }
        $scope.myFunc = function(){
            var str =  $("input[name='pwd']").val();
            // 用户名正则，4到16位（数字）  密码强度为弱
            var uPattern = /^[0-9]{6,}$/;
            //用户名正则，4到16位（字母，数字）  密码强度为中
            var uPatterns = /^[a-zA-Z0-9]{6,}$/;
             //    密码弱的时候
            if(str.search(uPattern) == -1 ){

                $('.pwd_bottom').eq(0).attr("id","pwd_lower");
            }else{
                $('.pwd_bottom').eq(0).removeAttr("id","pwd_lower");
            };
            // 密码中的时候
            if(str.search(uPatterns)==0 && str.search(uPattern) == -1){
                $('.pwd_bottom').eq(1).attr("id","pwd_middle");
                $('.pwd_bottom').eq(0).removeAttr("id","pwd_lower"); 
            }else{
                 $('.pwd_bottom').eq(1).removeAttr("id","pwd_middle");
            };            
        }
        $scope.sub = function(){
            if($scope.users.username != "" 
            && $scope.users.email != "" 
            && $scope.users.pwd != "" 
            && $scope.users.repwd != "" 
            && $scope.users.qq != "" 
            && $scope.users.wechat != ""){           
                var url = "__APP__/Register/addUsers";
                $http({
                    url:url,
                    method:"POST",
                    headers:{
                            "Content-type":"application/x-www-form-urlencoded"
                    },
                    data:{
                            username:$scope.users.username,
                            email:$scope.users.email,
                            pwd: $scope.users.pwd,
                            repwd:$scope.users.repwd,
                            qq:$scope.users.qq,
                            wechat:$scope.users.wechat
                    }
                }).success(function(data){
                        if(data.status==1){
                            window.location.href="__APP__/Login/login";
                            alert("注册成功返回登陆");
                            
                        }else{
                            alert(data.info);
                        }
                        console.log(data);
                })

            }else{
                //FF/{谷歌浏览器用这个 
                (!document.all) ? alert("--用户名不能为空\\n--email不能为空\\n--登录密码不能为空") : alert("--用户名不能为空\\n--email不能为空\\n--登录密码不能为空");
                
            }
        }
        
                                


    });
</script>


</html>